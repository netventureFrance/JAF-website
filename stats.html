<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Consultez les statistiques de propriété du Jardin aux Fontaines avec des graphiques interactifs.">
    <title>Statistiques - JAF.immo | Le Jardin aux Fontaines</title>

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- Chart.js v4 depuis jsDelivr -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 1rem 0;
            width: 100%;
            z-index: 100;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-content {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .logo {
            position: absolute;
            left: 0;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 2rem;
        }
        
        nav ul li a {
            text-decoration: none;
            color: var(--dark-color);
            font-weight: 500;
            transition: color 0.3s;
        }
        
        nav ul li a:hover {
            color: var(--secondary-color);
        }
        
        .stats-section {
            flex: 1;
            padding: 2rem 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--primary-color);
        }
        
        .stats-container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card.blue {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .stat-card.green {
            background-color: rgba(46, 204, 113, 0.1);
        }
        
        .stat-card.yellow {
            background-color: rgba(241, 196, 15, 0.1);
        }
        
        .stat-card.red {
            background-color: rgba(231, 76, 60, 0.1);
        }
        
        .stat-title {
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .stat-note {
            font-size: 0.9rem;
            color: #666;
        }
        
        .chart-container {
            height: 400px;
            margin-bottom: 3rem;
            position: relative;
        }
        
        .chart-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .legend {
            display: flex;
            justify-content: center;
            margin-top: 1rem;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 0 1rem;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 4px;
            margin-right: 8px;
        }
        
        .pie-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 1rem;
        }
        
        .pie-legend-item {
            display: flex;
            align-items: center;
            margin: 0.5rem 1rem;
        }
        
        .btn {
            display: inline-block;
            background-color: var(--secondary-color);
            color: white;
            padding: 0.8rem 2rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .back-button {
            text-align: center;
            margin-top: 2rem;
        }
        
        footer {
            background-color: var(--dark-color);
            color: white;
            text-align: center;
            padding: 2rem 0;
            margin-top: 2rem;
        }
        
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            width: 90%;
            max-width: 400px;
            padding: 2rem;
            border-radius: 10px;
            text-align: center;
            position: relative;
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        input[type="password"] {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }
        
        .error-message {
            color: var(--accent-color);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        /* Styles pour la carte interactive */
        .map-container {
            margin-top: 3rem;
            margin-bottom: 2rem;
        }
        
        .interactive-map {
            position: relative;
            width: 100%;
            height: 400px;
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            background-color: #e6f7ff;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }
        
        .map-svg {
            width: 100%;
            height: 100%;
        }
        
        .fountain-area {
            cursor: pointer;
            transition: fill 0.3s ease;
        }
        
        .fountain-details {
            background-color: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-top: 1.5rem;
            display: none;
        }
        
        .fountain-details h3 {
            font-size: 1.25rem;
            color: var(--secondary-color);
            margin-bottom: 0.8rem;
        }
        
        .fountain-details p {
            margin-bottom: 1rem;
            color: #555;
        }
        
        .fountain-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .stat-box {
            padding: 0.8rem;
            border-radius: 8px;
        }
        
        .stat-box.blue {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .stat-box.purple {
            background-color: rgba(155, 89, 182, 0.1);
        }
        
        .stat-box.green {
            background-color: rgba(46, 204, 113, 0.1);
        }
        
        .stat-box.yellow {
            background-color: rgba(241, 196, 15, 0.1);
        }
        
        .stat-name {
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .progress-bar {
            height: 2rem;
            width: 100%;
            background-color: #ecf0f1;
            border-radius: 1rem;
            overflow: hidden;
            margin-top: 0.5rem;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 500;
            transition: width 0.5s ease;
        }
        
        .map-helper {
            text-align: center;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
            color: #6c757d;
        }
        
        .map-legend {
            margin-top: 1.5rem;
            background-color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .map-legend h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .legend-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.8rem;
        }
        
        @media (min-width: 768px) {
            .legend-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media screen and (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 300px;
            }

            .interactive-map {
                height: 300px;
            }
        }
    </style>
</head>
<body>
    <header role="banner">
        <div class="container">
            <div class="header-content">
                <a href="index.html" class="logo" aria-label="Retour à l'accueil">
                    <i class="fas fa-fountain" aria-hidden="true"></i>
                    Le Jardin aux Fontaines
                </a>
                <button class="menu-toggle" aria-label="Toggle menu" aria-expanded="false">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <nav role="navigation" aria-label="Navigation principale">
                    <ul>
                        <li><a href="#" id="contact-link"><i class="fas fa-database" aria-hidden="true"></i> JAF Data</a></li>
                        <li><a href="quiz.html"><i class="fas fa-question-circle" aria-hidden="true"></i> Quiz</a></li>
                        <li><a href="stats.html" aria-current="page"><i class="fas fa-chart-bar" aria-hidden="true"></i> Statistiques</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="stats-section">
        <div class="container">
            <h1 class="section-title">Statistiques de Propriété JAF</h1>
            
            <div class="stats-container">
                <h2 class="chart-title">Aperçu général</h2>
                <div class="stats-grid">
                    <div class="stat-card blue">
                        <div class="stat-title">Nombre total de propriétaires</div>
                        <div class="stat-value">294</div>
                    </div>
                    <div class="stat-card green">
                        <div class="stat-title">Non identifiés au JAF</div>
                        <div class="stat-value">5</div>
                    </div>
                    <div class="stat-card yellow">
                        <div class="stat-title">Propriétaires résidant au JAF</div>
                        <div class="stat-value">165</div>
                        <div class="stat-note">(56% de tous les propriétaires)</div>
                    </div>
                    <div class="stat-card red">
                        <div class="stat-title">Propriétaires externes</div>
                        <div class="stat-value">124</div>
                        <div class="stat-note">(42% de tous les propriétaires)</div>
                    </div>
                </div>
                
                <h2 class="chart-title">Répartition par fontaine</h2>
                <div class="chart-container">
                    <canvas id="bar-chart-1"></canvas>
                </div>
                
                <h2 class="chart-title">Pourcentage de propriétaires par fontaine</h2>
                <div class="chart-container">
                    <canvas id="bar-chart-2"></canvas>
                </div>
                
                <h2 class="chart-title">Répartition des Résidents vs Externes au JAF</h2>
                <div class="chart-container">
                    <canvas id="pie-chart"></canvas>
                </div>
                <div class="pie-legend">
                    <div class="pie-legend-item">
                        <div class="legend-color" style="background-color: rgb(37, 99, 235); border-radius: 50%;"></div>
                        <div style="font-weight: 500;">Résidents au JAF: 170 (58%)</div>
                    </div>
                    <div class="pie-legend-item">
                        <div class="legend-color" style="background-color: rgb(245, 158, 11); border-radius: 50%;"></div>
                        <div style="font-weight: 500;">Externes (Locataires): 124 (42%)</div>
                    </div>
                </div>
                <!-- Carte interactive du JAF -->
                <div class="map-container">
                    <h2 class="chart-title">Carte Interactive du JAF</h2>
                    <p style="text-align: center; margin-bottom: 1rem; color: #666;">Cliquez sur une fontaine pour voir ses détails</p>
                    
                    <div class="interactive-map">
                        <svg class="map-svg" viewBox="0 0 800 600">
                            <!-- Main container -->
                            <path 
                                d="M 400,50 L 750,200 L 650,500 L 150,500 L 50,200 Z" 
                                fill="#e6f7ff" 
                                stroke="#333" 
                                strokeWidth="2"
                            />
                            
                            <!-- Aux Devins -->
                            <path 
                                d="M 400,50 L 750,200 L 400,200 Z" 
                                fill="#bbdefb" 
                                stroke="#666" 
                                strokeWidth="2"
                                class="fountain-area"
                                id="devins-area"
                            />
                            
                            <!-- Aux Prophètes -->
                            <path 
                                d="M 400,50 L 400,200 L 150,200 L 50,200 Z" 
                                fill="#d4c6f9" 
                                stroke="#666" 
                                strokeWidth="2"
                                class="fountain-area"
                                id="prophetes-area"
                            />
                            
                            <!-- Aux Songes -->
                            <path 
                                d="M 150,200 L 400,200 L 400,500 L 150,500 Z" 
                                fill="#c6f6d5" 
                                stroke="#666" 
                                strokeWidth="2"
                                class="fountain-area"
                                id="songes-area"
                            />
                            
                            <!-- Aux Chimères -->
                            <path 
                                d="M 400,200 L 750,200 L 650,500 L 400,500 Z" 
                                fill="#feebc8" 
                                stroke="#666" 
                                strokeWidth="2"
                                class="fountain-area"
                                id="chimeres-area"
                            />
                            
                            <!-- Fountain Icons and Labels -->
                            <circle cx="525" cy="120" r="15" fill="#2b6cb0" />
                            <text x="525" y="90" text-anchor="middle" fill="#1a365d" font-weight="bold">Aux Devins</text>
                            
                            <circle cx="225" cy="120" r="15" fill="#6b46c1" />
                            <text x="225" y="90" text-anchor="middle" fill="#44337a" font-weight="bold">Aux Prophètes</text>
                            
                            <circle cx="275" cy="350" r="15" fill="#38a169" />
                            <text x="275" y="380" text-anchor="middle" fill="#276749" font-weight="bold">Aux Songes</text>
                            
                            <circle cx="525" cy="350" r="15" fill="#d97706" />
                            <text x="525" y="380" text-anchor="middle" fill="#7c2d12" font-weight="bold">Aux Chimères</text>
                            
                            <!-- Central Fountain 
                            <circle cx="400" cy="200" r="20" fill="#3182ce" />
                            <circle cx="400" cy="200" r="15" fill="#63b3ed" />
                            <circle cx="400" cy="200" r="10" fill="#90cdf4" />
                            <circle cx="400" cy="200" r="5" fill="#fff" />
                            <text x="400" y="240" text-anchor="middle" fill="#2c5282" font-weight="bold">Fontaine Centrale</text>-->
                            
                            <!-- Main paths -->
                            <path 
                                d="M 400,50 L 400,500" 
                                stroke="#888" 
                                strokeWidth="5"
                                stroke-dasharray="10,5"
                            />
                            <path 
                                d="M 50,200 L 750,200" 
                                stroke="#888" 
                                strokeWidth="5"
                                stroke-dasharray="10,5"
                            />
                        </svg>
                    </div>
                    
                    <!-- Détails de la fontaine (caché par défaut) -->
                    <div class="fountain-details" id="fountain-details">
                        <h3 id="fountain-name">Nom de la fontaine</h3>
                        <p id="fountain-description">Description de la fontaine</p>
                        
                        <div class="fountain-stats">
                            <div class="stat-box blue">
                                <div class="stat-name">Propriétaires</div>
                                <div class="stat-number" id="fountain-owners">0</div>
                            </div>
                            <div class="stat-box purple">
                                <div class="stat-name">Locataires</div>
                                <div class="stat-number" id="fountain-tenants">0</div>
                            </div>
                            <div class="stat-box green">
                                <div class="stat-name">Total logements</div>
                                <div class="stat-number" id="fountain-total">0</div>
                            </div>
                            <div class="stat-box yellow">
                                <div class="stat-name">Taux propriétaires</div>
                                <div class="stat-number" id="fountain-percentage">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar">
                            <div class="progress-fill" id="fountain-progress">0%</div>
                        </div>
                    </div>
                    
                    <div class="map-helper" id="map-helper">
                        Cliquez sur une zone de la carte pour afficher les informations détaillées sur la fontaine
                    </div>
                    
                    <!-- Legend -->
                    <div class="map-legend">
                        <h3>Légende</h3>
                        <div class="legend-grid">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #bbdefb;"></div>
                                <span>Aux Devins</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #d4c6f9;"></div>
                                <span>Aux Prophètes</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #c6f6d5;"></div>
                                <span>Aux Songes</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #feebc8;"></div>
                                <span>Aux Chimères</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="back-button">
                <a href="index.html" class="btn"><i class="fas fa-arrow-left"></i> Retour</a>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 Le Jardin aux Fontaines. Tous droits réservés.</p>
        </div>
    </footer>

    <!-- Password Modal -->
    <div class="modal" id="password-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Accès protégé</h2>
            <p>Veuillez entrer le mot de passe pour accéder à JAF Data.</p>
            <div class="form-group">
                <label for="password">Mot de passe</label>
                <input type="password" id="password">
                <div class="error-message" id="password-error">Mot de passe incorrect. Veuillez réessayer.</div>
            </div>
            <button class="btn" id="submit-password">Accéder</button>
        </div>
    </div>

    <script>
        // Vérifier que Chart.js est chargé
        window.addEventListener('load', function() {
            console.log('Page loaded');
            console.log('Chart.js disponible:', typeof Chart !== 'undefined');

            if (typeof Chart === 'undefined') {
                console.error('Chart.js n\'est pas chargé!');
                return;
            }

            // Chart.js implementation
            // Data
            const propertyData = [
                { name: 'Aux Devins', proprietaires: 49, locataires: 11, total: 60, percentage: 82 },
                { name: 'Aux Prophètes', proprietaires: 19, locataires: 57, total: 76, percentage: 25 },
                { name: 'Aux Songes', proprietaires: 31, locataires: 32, total: 63, percentage: 49 },
                { name: 'Aux Chimères', proprietaires: 66, locataires: 50, total: 116, percentage: 57 }
            ];
            
            // First bar chart
            console.log('Création du graphique 1...');
            const barCtx1 = document.getElementById('bar-chart-1');
            if (!barCtx1) {
                console.error('Canvas bar-chart-1 introuvable!');
                return;
            }
            const ctx1 = barCtx1.getContext('2d');
            const chart1 = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: propertyData.map(item => item.name),
                    datasets: [
                        {
                            label: 'Propriétaires',
                            data: propertyData.map(item => item.proprietaires),
                            backgroundColor: 'rgba(37, 99, 235, 0.8)',
                            borderColor: 'rgb(37, 99, 235)',
                            borderWidth: 2,
                            borderRadius: 8,
                            hoverBackgroundColor: 'rgba(37, 99, 235, 1)'
                        },
                        {
                            label: 'Locataires',
                            data: propertyData.map(item => item.locataires),
                            backgroundColor: 'rgba(14, 165, 233, 0.8)',
                            borderColor: 'rgb(14, 165, 233)',
                            borderWidth: 2,
                            borderRadius: 8,
                            hoverBackgroundColor: 'rgba(14, 165, 233, 1)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                padding: 15,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            borderColor: 'rgba(37, 99, 235, 0.5)',
                            borderWidth: 1,
                            cornerRadius: 8
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(203, 213, 225, 0.3)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#475569'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                color: '#334155'
                            }
                        }
                    }
                }
            });
            console.log('Graphique 1 créé avec succès');

            // Second bar chart
            const barCtx2 = document.getElementById('bar-chart-2').getContext('2d');
            new Chart(barCtx2, {
                type: 'bar',
                data: {
                    labels: propertyData.map(item => item.name),
                    datasets: [
                        {
                            label: 'Taux de propriété (%)',
                            data: propertyData.map(item => item.percentage),
                            backgroundColor: [
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(14, 165, 233, 0.8)',
                                'rgba(16, 185, 129, 0.8)'
                            ],
                            borderColor: [
                                'rgb(245, 158, 11)',
                                'rgb(239, 68, 68)',
                                'rgb(14, 165, 233)',
                                'rgb(16, 185, 129)'
                            ],
                            borderWidth: 2,
                            borderRadius: 8,
                            hoverBackgroundColor: [
                                'rgba(245, 158, 11, 1)',
                                'rgba(239, 68, 68, 1)',
                                'rgba(14, 165, 233, 1)',
                                'rgba(16, 185, 129, 1)'
                            ]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                padding: 15,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            borderColor: 'rgba(37, 99, 235, 0.5)',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '%';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: 'rgba(203, 213, 225, 0.3)',
                                drawBorder: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#475569',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12,
                                    weight: '500'
                                },
                                color: '#334155'
                            }
                        }
                    }
                }
            });
            
            // Données pour le graphique circulaire
            const residenceData = [
                { name: 'Résidents au JAF', value: 170 }, // 165 propriétaires + 5 non identifiés
                { name: 'Externes (Locataires)', value: 124 } // Propriétaires externes qui louent leur logement
            ];

            const COLORS = ['rgba(37, 99, 235, 0.8)', 'rgba(245, 158, 11, 0.8)'];
            const BORDER_COLORS = ['rgb(37, 99, 235)', 'rgb(245, 158, 11)'];

            // Créer le graphique circulaire
            const pieCtx = document.getElementById('pie-chart').getContext('2d');
            new Chart(pieCtx, {
                type: 'pie',
                data: {
                    labels: residenceData.map(item => item.name),
                    datasets: [
                        {
                            data: residenceData.map(item => item.value),
                            backgroundColor: COLORS,
                            borderColor: BORDER_COLORS,
                            borderWidth: 3,
                            hoverBackgroundColor: ['rgba(37, 99, 235, 1)', 'rgba(245, 158, 11, 1)'],
                            hoverBorderWidth: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false // Nous utilisons notre propre légende
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 12,
                            titleFont: {
                                size: 14,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 13
                            },
                            borderColor: 'rgba(37, 99, 235, 0.5)',
                            borderWidth: 1,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${context.label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Carte interactive
            // Données des fontaines
            const fountainData = {
                devins: {
                    name: 'Aux Devins',
                    proprietaires: 49,
                    locataires: 11,
                    total: 60,
                    percentage: 82,
                    description: 'La fontaine Aux Devins est la plus petite des fontaines mais possède le plus haut taux de propriétaires résidents (82%).'
                },
                prophetes: {
                    name: 'Aux Prophètes',
                    proprietaires: 19,
                    locataires: 57,
                    total: 76,
                    percentage: 25,
                    description: 'La fontaine Aux Prophètes a le plus faible taux de propriétaires résidents (25%) et contient principalement des locataires.'
                },
                songes: {
                    name: 'Aux Songes',
                    proprietaires: 31,
                    locataires: 32,
                    total: 63,
                    percentage: 49,
                    description: 'La fontaine Aux Songes présente un équilibre presque parfait entre propriétaires et locataires (49% de propriétaires).'
                },
                chimeres: {
                    name: 'Aux Chimères',
                    proprietaires: 66,
                    locataires: 50,
                    total: 116,
                    percentage: 57,
                    description: 'La fontaine Aux Chimères est la plus grande des fontaines avec 116 logements et un bon taux de propriétaires résidents (57%).'
                }
            };

            // DOM elements
            const fountainAreas = document.querySelectorAll('.fountain-area');
            const fountainDetails = document.getElementById('fountain-details');
            const mapHelper = document.getElementById('map-helper');
            const fountainName = document.getElementById('fountain-name');
            const fountainDescription = document.getElementById('fountain-description');
            const fountainOwners = document.getElementById('fountain-owners');
            const fountainTenants = document.getElementById('fountain-tenants');
            const fountainTotal = document.getElementById('fountain-total');
            const fountainPercentage = document.getElementById('fountain-percentage');
            const fountainProgress = document.getElementById('fountain-progress');

            // Couleurs d'accentuation pour les areas
            const areaColors = {
                devins: { default: '#bbdefb', highlight: '#90cdf4' },
                prophetes: { default: '#d4c6f9', highlight: '#c3b9f8' },
                songes: { default: '#c6f6d5', highlight: '#9ae6b4' },
                chimeres: { default: '#feebc8', highlight: '#fbd38d' }
            };

            // Variable pour suivre l'area active
            let activeArea = null;

            // Ajouter des event listeners pour chaque zone de fontaine
            fountainAreas.forEach(area => {
                const areaId = area.id.split('-')[0]; // extraire devins, prophetes, etc.
                
                // Événement au clic
                area.addEventListener('click', () => {
                    // Si on clique sur l'area active, on désactive
                    if (activeArea === areaId) {
                        resetAreas();
                        activeArea = null;
                        fountainDetails.style.display = 'none';
                        mapHelper.style.display = 'block';
                    } else {
                        // Sinon, on active la nouvelle area
                        resetAreas();
                        activeArea = areaId;
                        area.setAttribute('fill', areaColors[areaId].highlight);
                        
                        // Afficher les détails
                        updateFountainDetails(areaId);
                        fountainDetails.style.display = 'block';
                        mapHelper.style.display = 'none';
                    }
                });
                
                // Événements de survol
                area.addEventListener('mouseenter', () => {
                    if (activeArea !== areaId) {
                        area.setAttribute('fill', areaColors[areaId].highlight);
                    }
                });
                
                area.addEventListener('mouseleave', () => {
                    if (activeArea !== areaId) {
                        area.setAttribute('fill', areaColors[areaId].default);
                    }
                });
            });

            // Réinitialiser toutes les areas à leur couleur par défaut
            function resetAreas() {
                fountainAreas.forEach(area => {
                    const areaId = area.id.split('-')[0];
                    area.setAttribute('fill', areaColors[areaId].default);
                });
            }

            // Mettre à jour les détails affichés pour une fontaine
            function updateFountainDetails(areaId) {
                const data = fountainData[areaId];
                
                fountainName.textContent = data.name;
                fountainDescription.textContent = data.description;
                fountainOwners.textContent = data.proprietaires;
                fountainTenants.textContent = data.locataires;
                fountainTotal.textContent = data.total;
                fountainPercentage.textContent = data.percentage + '%';
                
                // Animer la barre de progression
                fountainProgress.style.width = '0%';
                setTimeout(() => {
                    fountainProgress.style.width = data.percentage + '%';
                    fountainProgress.textContent = data.percentage + '%';
                }, 50);
            }
        });
    </script>
    <script src="nav.js"></script>
    <script src="auth.js"></script>
</body>
</html>